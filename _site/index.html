<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="generator" content="jekill" />
  <link rel="stylesheet" href="/stylesheets/default.css" type="text/css" media="screen" />
  <link rel="stylesheet" href="/stylesheets/syntax.css" type="text/css" media="screen" />
  <title>Rafael Souza</title>
</head>
<body>
  <div id="wrapper">
    <div id="header">
      <h1>Rafael Souza</h1>
    </div>
    <div id="content">
      


  <h2>Hora Extra Em Porto Alegre</h2>
  <div class="post">
    <p>O Tailor lançou a idéia no twitter e eu apoiei, então, semana que vem, #horaextra na Cidade Baixa, em Porto Alegre, mais exatamente no Copão</p>
<p>A idéia é juntar um monte (ou não) de nerds pra falar de trabalho, tecnologia, frameworks, programação, enfim, tudo o que a gente mais gosta</p>
<p>Então, segunda-feira, 19:30, Copão. Aparece lá!</p>
  </div>



  <h2>Asp Net Mvc E Suas Actionresult</h2>
  <div class="post">
    <p>O framework <span class="caps">MVC</span> da Microsoft usa um determinado objeto para definir qual tipo de resultado/output a <em>action</em> executada deve retornar. São eles:</p>
<ul>
	<li><code>ContentResult</code> &#8211; Pode ser usado para retornar textos simples.</li>
	<li><code>EmptyResult</code> &#8211; Esse serve para retornar resultados em branco, quando quiser que o output seja vazio.</li>
	<li><code>HttpUnauthorizedResult</code> &#8211; Usado quando o usuário não tem permissão para executar a action. Retorna o 401 como <em>status</em> da requisição.</li>
	<li><code>JsonResult</code> &#8211; Serializa um objeto em formato <span class="caps">JSON</span>, bom para ser usando em requisições <span class="caps">AJAX</span>.</li>
	<li><code>RedirectResult</code> &#8211; Resultado usado para redirecionamentos.</li>
	<li><code>RedirectToRouteResult</code> &#8211; Também usado para redirecionamentos, mas a <span class="caps">URL</span> está ligada a uma rota.</li>
	<li><code>ViewResultBase</code> &#8211; Classe abstrata, usada para renderizar HTMLs.
	<ul>
		<li><code>PartialViewResult</code> &#8211; Estende <code>ViewResultBase</code> para renderizar as views e seus HTMLs.</li>
	</ul></li>
	<li><code>BinaryResult</code> &#8211; Classe abstrata usada para resultados binários.
	<ul>
		<li><code>BinaryStreamResult</code> &#8211; Estende <code>BinaryResult</code>, pode ser usado para escrever imagens direto no stream do resutado.</li>
	</ul></li>
</ul>
<p>Porém, em alguns casos, retornar um texto simples, ou um <span class="caps">JSON</span> pequeninho, é meio chato. Considere o código abaixo:</p>
<div class="highlight"><pre><span class="n">JsonResult</span> <span class="n">json</span> <span class="o">=</span> <span class="n">new</span> <span class="n">JsonResult</span><span class="p">();</span>
<span class="n">json</span><span class="p">.</span><span class="n">ContentType</span> <span class="o">=</span> <span class="s">&quot;text/javascript&quot;</span><span class="p">;</span>
<span class="n">json</span><span class="p">.</span><span class="n">Data</span> <span class="o">=</span> <span class="n">new</span> <span class="p">{</span> <span class="n">success</span> <span class="o">=</span> <span class="nb">true</span> <span class="p">};</span>
<span class="k">return</span> <span class="n">json</span><span class="p">;</span>
</pre>
</div><p>Isso poderia ser mais simples não? Porém, a classe <code>JsonResult</code>, e nenhuma outra <code>ActionResult</code> aceita parâmetros no construtor. Por isso criei <a href="http://gist.github.com/138225">duas classes</a> que podem ser usadas como <code>ActionResult</code>, para simplificar essa tarefa. Elas devem ser usadas assim:</p>
<div class="highlight"><pre><span class="k">return</span> <span class="n">new</span> <span class="n">SimpleResult</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
<span class="k">return</span> <span class="n">new</span> <span class="n">SimpleResult</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">return</span> <span class="n">new</span> <span class="n">SimpleResult</span><span class="p">(</span><span class="mf">1257.14</span><span class="p">);</span>
<span class="k">return</span> <span class="n">new</span> <span class="n">SimpleResult</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</pre>
</div><p>e</p>
<div class="highlight"><pre><span class="k">return</span> <span class="n">new</span> <span class="n">SimpleJsonResult</span><span class="p">(</span><span class="n">new</span> <span class="p">{</span> <span class="n">success</span> <span class="o">=</span> <span class="nb">true</span> <span class="p">});</span>
</pre>
</div><p>Pronto, agora é hora de refatorar código. :)</p>
<p><strong><span class="caps">UPDATE</span>:</strong> Conforme o Guilherme comentou ali embaixo, o <span class="caps">ASP</span>.<span class="caps">NET</span> <span class="caps">MVC</span> tem um método que já simplifica as coisas.</p>
<div class="highlight"><pre><span class="k">return</span> <span class="n">Json</span><span class="p">(</span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span>
<span class="k">return</span> <span class="n">Json</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">return</span> <span class="n">Json</span><span class="p">(</span><span class="mf">1257.14</span><span class="p">);</span>
<span class="k">return</span> <span class="n">Json</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</pre>
</div><p>e</p>
<div class="highlight"><pre><span class="k">return</span> <span class="n">Json</span><span class="p">(</span><span class="n">new</span> <span class="p">{</span> <span class="n">success</span> <span class="o">=</span> <span class="nb">true</span> <span class="p">});</span>
</pre>
</div>
  </div>


    </div>
  </div>
</body>
</html>