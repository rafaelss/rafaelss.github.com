--- 
layout: post
title: "PDO: bindParam ou bindValue?"
wordpress_id: 39
wordpress_url: http://rafaelss.com/?p=39
---
<p>Programando hoje uma validação para o framework que estou desenvolvendo me deparei com um problema usando variáveis em <span class="caps">SQL</span>, mais especificamente usando variáveis com o <span class="caps">PDO</span>.</p>
<p>Escrevendo os testes unitários para essas validações notei que precisava mudar a forma como passava os parâmetros para a <span class="caps">SQL</span>, ao invés de passar no <code>execute</code>, precisaria passar usando uma função própria para isso.</p>
<p>Lendo o manual, achei três opções de bind, <code>bindColumn</code>, <code>bindParam</code> e <code>bindValue</code>, depois de ler a documentação, optei pela <code>bindParam</code>, pois <code>bindColumn</code> é usado para atribuir o resultado para uma variável diretamente e bindColumn&#8230; eu só fui ver depois :P</p>
<p>Meus testes já estavam prontos e passando corretamente, mas quando fiz a mudança começou a não passar mais, então comecei a debugar para ver o que estava acontecendo. Depois de horas perdidas descobri o problema, não posso usar <code>bindParam</code>, tenho que usar <code>bindValue</code>.</p>
<p>O método <code>bindParam</code> recebe o valor do parâmetro por referência, então se o valor da variável mudar entre o chamada de <code>bindParam</code> e <code>execute</code>, o valor do parâmetro muda, alterando o resultado da <span class="caps">SQL</span>, coloquei <code>bindValue</code> e tudo voltou ao normal, com os testes passando novamente. Mas o que me deixa intrigado é que o meu código não mudava nada na variável, não tinha nada entre os métodos que pudesse fazer com o o resultado fosse diferente.</p>
<p>Mas fica a lição, ler a documentação melhor da próxima vez ;)</p>